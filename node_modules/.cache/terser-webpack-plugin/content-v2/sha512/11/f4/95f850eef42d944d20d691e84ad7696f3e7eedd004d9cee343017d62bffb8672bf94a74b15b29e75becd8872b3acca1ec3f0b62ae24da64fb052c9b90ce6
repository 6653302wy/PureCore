{"code":"!function(t){var e={};function o(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=t,o.c=e,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&\"object\"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,\"a\",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p=\"\",o(o.s=0)}([function(t,e,o){t.exports=o(1)},function(t,e,o){\"use strict\";o.r(e);var n,r,i=function(){function t(){this._keys=[],this._values=[]}return t.prototype.set=function(t,e){var o=this.indexOf(t);o>=0?this._values[o]=e:(this._keys.push(t),this._values.push(e))},t.prototype.get=function(t){var e=this.indexOf(t);return e<0?null:this._values[e]},t.prototype.remove=function(t){var e=this.indexOf(t);return e>=0&&(this._keys.splice(e,1),this._values.splice(e,1),!0)},t.prototype.clear=function(){this._values.length=0,this._keys.length=0},Object.defineProperty(t.prototype,\"values\",{get:function(){return this._values},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,\"keys\",{get:function(){return this._keys},enumerable:!0,configurable:!0}),t.prototype.indexOf=function(t){var e=this._keys.indexOf(t);return e>=0?e:(t=\"string\"==typeof t?Number(t):\"number\"==typeof t?t.toString():t,this._keys.indexOf(t))},t}(),a=function(){function t(){}return t.getFUIImg=function(e){return t.ImageUrl+e+\".png\"},t.Debug_panel=!0,t.Debug_log=!0,t.Platform=0,t.CurrServerUrl=\"\",t.Version=\"1.0.0\",t.ImageUrl=\"res/GIMG/\",t}(),s=function(){function t(){}return t.log=function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];a.Debug_log&&(e.length>1?console.log(t,e):1==e.length?console.log(t,e[0]):console.log(t))},t.err=function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];a.Debug_log&&(e.length>1?console.error(t,e):1==e.length?console.error(t,e[0]):console.error(t))},t.alert=function(t){a.Debug_log&&alert(t)},t}(),u=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),l=function(t){function e(){var e=t.call(this)||this;return e.resGroupPool={},e}return u(e,t),e.getinstance=function(){return e._instance?e._instance:e._instance=new e},e.prototype.getResArray=function(t){return e.CUR_GROUP_URLS=[],e.CUR_GROUP_URLS_FORMAT=[],this.resGroupPool[t]?this.resGroupPool[t]:(this.loadGroup(t),this.resGroupPool[t]=e.CUR_GROUP_URLS_FORMAT,e.CUR_GROUP_URLS_FORMAT)},e.prototype.getNameFromPool=function(t){return this.resGroupPool[t]},e.prototype.loadGroup=function(t){if(!t.length)return s.log(\"资源组名称不能为空！\"+t),\"\";e.CUR_GROUP_NAME=t,this.onLoaded()},e.prototype.onLoaded=function(){this.jsonData||(this.jsonData=f.ins.getRes(e.RES_GROUP),f.ins.clearRes(e.RES_GROUP)),this.initGroupKey(this.jsonData)},e.prototype.initGroupKey=function(t){if(t){e.CUR_GROUP_KEYS=\"\";for(var o=t.groups.length,n=null,r=0;r<o;++r)if(e.CUR_GROUP_NAME===t.groups[r].name){e.CUR_GROUP_KEYS=t.groups[r].keys,n=t.groups[r];break}n?\"\"!==e.CUR_GROUP_KEYS?this.initResUrl(t):s.log(e.CUR_GROUP_NAME+\" 资源组内容为空！\"):s.log(e.CUR_GROUP_NAME+\" 资源组名字不存在！\")}else s.log(\"资源配置json文件读取错误！\")},e.prototype.initResUrl=function(t){if(t&&\"\"!==e.CUR_GROUP_KEYS){var o=e.CUR_GROUP_KEYS.split(\",\"),n=o.length,r=t.resources.length;e.CUR_GROUP_URLS=[],e.CUR_GROUP_URLS_FORMAT=[];for(var i=0;i<n;++i)for(var a=o[i],s=0;s<r;++s){var u=t.resources[s];if(\"atlas\"===u.type&&u.name===a){e.CUR_GROUP_URLS.push(u.url),e.CUR_GROUP_URLS_FORMAT.push({url:u.url,type:Laya.Loader.ATLAS});break}if(\"json\"===u.type&&u.name===a)e.CUR_GROUP_URLS.push(u.url),e.CUR_GROUP_URLS_FORMAT.push({url:u.url,type:Laya.Loader.JSON});else if(\"sound\"===u.type&&u.name===a)e.CUR_GROUP_URLS.push(u.url),e.CUR_GROUP_URLS_FORMAT.push({url:u.url,type:Laya.Loader.SOUND});else if(\"xml\"===u.type&&u.name===a)e.CUR_GROUP_URLS.push(u.url),e.CUR_GROUP_URLS_FORMAT.push({url:u.url,type:Laya.Loader.XML});else if(\"buffer\"!==u.type&&\"sprite3d\"!==u.type||u.name!==a){if(\"image\"===u.type&&u.name===a)e.CUR_GROUP_URLS.push(u.url),e.CUR_GROUP_URLS_FORMAT.push({url:u.url,type:Laya.Loader.IMAGE});else if(u.name===a){if(this.isJpgFormat(u.name)){e.CUR_GROUP_URLS.push(u.url),e.CUR_GROUP_URLS_FORMAT.push({url:u.url,type:Laya.Loader.IMAGE});break}}}else e.CUR_GROUP_URLS.push(u.url),e.CUR_GROUP_URLS_FORMAT.push({url:u.url,type:Laya.Loader.BUFFER})}}},e.prototype.isJpgFormat=function(t){if(t){var e=t.length;if(e<=3)return!1}return\"jpg\"===t[e-3]+t[e-2]+t[e-1]||\"ebp\"==t[e-3]+t[e-2]+t[e-1]},e.RES_GROUP=\"resGroup.json\",e.CUR_GROUP_NAME=\"\",e.CUR_GROUP_KEYS=\"\",e.CUR_GROUP_URLS=[],e.CUR_GROUP_URLS_FORMAT=[],e._instance=null,e}(Laya.EventDispatcher),c=function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),p=function(t){function e(){var e=t.call(this)||this;return e.regModules={},e._moduleDynamicList={},e._loadModuleLen=0,e.loadingModules=[],e._info={},e.moduleIsLoading=!1,e}return c(e,t),Object.defineProperty(e,\"inst\",{get:function(){return null==this._instance?this._instance=new e:this._instance},enumerable:!0,configurable:!0}),e.prototype.setup=function(t,e){this._stage=t,this._fa=e},e.prototype.registerModule=function(t,e){this.regModules[t+\"\"]=e},e.prototype.StartModule=function(t){var e=this;t instanceof Array?(this._loadModuleLen=t.length,t.forEach((function(t){e.addModule(t.key,t.info?t.info:null,t.dynaimcList?t.dynaimcList:null)}))):(this._loadModuleLen=1,this.addModule(t.key,t.info?t.info:null,t.dynaimcList?t.dynaimcList:null)),this.startLoad()},e.prototype.addModule=function(t,e,o){void 0===e&&(e=null),void 0===o&&(o=null);var n={key:t,info:e,dynamicList:o};this.loadingModules.push(n)},e.prototype.startLoad=function(){this.loadNext()},e.prototype.loadNext=function(){if(null==this.modules&&(this.modules={}),!this.moduleIsLoading&&this.loadingModules.length){var t=this.loadingModules.shift(),e=t.key;this._info[e]=t.info,this._moduleDynamicList[e]=t.dynamicList;var o=this.getModule(e);o?(o.start(this._fa,this._info[e]),this.loadNext()):(o=this.newModuleByKey(e))?(this.modules[e]=o,this.loadModule(o,e)):this.loadNext()}},e.prototype.loadModule=function(t,e){var o=t.getResGroup();s.log(e+\" 模块所需资源组列表====\",o.toString());var n=[];o.forEach((function(t){var e=l.getinstance().getResArray(t);n=n.concat(e)}));var r=this._moduleDynamicList[e];r&&r.length&&(n=n.concat(r)),n.length>0?f.ins.loadRes(n,Laya.Handler.create(this,this.startModule,[t,e]),e):(this._loadModuleLen--,this.moduleIsLoading=!1,this.startModule(t,e))},e.prototype.startModule=function(t,e){this.moduleIsLoading=!1,t&&(s.log(\"启动模块 。。\"+e),t.start(this._fa,this._info[e]),t=null),this.loadNext()},e.prototype.killModule=function(t,e){void 0===e&&(e=!1);var o=this.modules[t];o&&(s.log(\"销毁模块=====\",t),o.dispose(),delete this.modules[t],e&&this.clearResGroup(t))},e.prototype.clearResGroup=function(t){f.ins.clearRes(null,t)},e.prototype.checkMoudleExist=function(t){return!!this.getModule(t)},e.prototype.killAllModule=function(){for(var t in this.modules)this.killModule(t)},e.prototype.getModule=function(t){return null==this.modules?null:this.modules[t]},e.prototype.newModuleByKey=function(t){var e,o=this.regModules[t+\"\"];return o&&(e=new o),e},e._instance=null,e}(Laya.EventDispatcher),h=function(){function t(){}return t.getSingle=function(t){var e;return t.hasOwnProperty(\"_inst\")&&(e=t._inst),e||(e=new t,Object.defineProperty(t,\"_inst\",{value:e})),e},t.isArray=function(t){return!(!t||t.constructor!=Array)},t.addMixSortToArr=function(){Array.prototype.shuffle||(Array.prototype.shuffle=function(){for(var t,e,o=this.length;o;t=parseInt((Math.random()*o).toString()),e=this[--o],this[o]=this[t],this[t]=e);})},t.getNoRepeatListFromArr=function(t,e){void 0===e&&(e=null);for(var o=[],n=0;n<t.length;n++)e?-1==o.indexOf(t[n][e])&&o.push(t[n][e]):-1==o.indexOf(t[n])&&o.push(t[n]);return o},t.deepCopy=function(t){return JSON.parse(JSON.stringify(t))},t.deepCopyArr=function(t){return t.slice()},t.StringParseToNumberArray=function(t,e){if(!t)return null;for(var o=t.split(e),n=[],r=0;r<o.length;r++)n.push(+o[r]);return n},t.TimeLineFunction=function(t,e,o){for(var n=0,r=function(r){var a=r<t.length?t[r]:0;n+=a,Laya.timer.once(n,i,(function(){(0,e[r].func)(e[r].arg),r>=e.length-1&&o&&o()}))},i=this,a=0;a<e.length;a++)r(a)},t.GetRandom=function(t){var e=Math.random()*t.length;return t[Math.floor(e)]},t.GetRandomNumInt=function(t,e){var o=e-t,n=Math.random();return t+Math.round(n*o)},t.GetRandomNum=function(t,e){var o=e-t;return t+Math.random()*o},t.BezierTween=function(t,e,o,n,r,i,a,s){var u=new(function(){function t(t,e,o,n){this.t=0,this.obj=n,this.p0=t,this.p1=e,this.p2=o}return Object.defineProperty(t.prototype,\"factor\",{get:function(){return this.t},set:function(t){this.t=t,this.obj.x=(1-t)*(1-t)*this.p0.x+2*t*(1-t)*this.p1.x+t*t*this.p2.x,this.obj.y=(1-t)*(1-t)*this.p0.y+2*t*(1-t)*this.p1.y+t*t*this.p2.y},enumerable:!0,configurable:!0}),t}())(t,e,o,n);return Laya.Tween.to(u,{factor:1},r,a,s,i,!1)},t.getObjKeys=function(t){var e=[];for(var o in t)e.push(o);return e},t.isImgRes=function(t){var e=this.getFileType(t);return-1!=[\"png\",\"jpg\",\"jpeg\",\"gif\",\"bmp\",\"webp\"].indexOf(e)},t.isD3Res=function(t){var e=this.getFileType(t);return-1!=[\"ls\",\"lh\"].indexOf(e)},t.isAtlasRes=function(t){var e=this.getFileType(t);return-1!=[\"atlas\"].indexOf(e)},t.getFileType=function(t){return Laya.Utils.getFileExtension(t)},t.isIOS=function(){return!!window.navigator.userAgent.match(/\\(i[^;]+;( U;)? CPU.+Mac OS X/)},t.check_support_webp=function(){if(t.isIOS)return!1;try{return 0==window.document.createElement(\"canvas\").toDataURL(\"image/webp\").indexOf(\"data:image/webp\")}catch(t){return!1}},t.setLocalCache=function(t,e){Laya.LocalStorage.setItem(t,e)},t.getLocalCache=function(t){return Laya.LocalStorage.getItem(t)},t.deleteLocalCache=function(t){Laya.LocalStorage.removeItem(t)},t.SendFacade=function(t,e,o){puremvc.Facade.getInstance().sendNotification(t,e,o)},t.Handler=function(t,e,o,n){return void 0===o&&(o=null),void 0===n&&(n=!0),Laya.Handler.create(t,e,o,n)},t.openMod=function(t,e,o){if(void 0===e&&(e=null),void 0===o&&(o=null),t instanceof Array){for(var n=[],r=0;r<t.length;r++){var i={};i.key=t[r],e&&e[r]&&(i.info=e[r]),o&&o[r]&&(i.dynaimcList=o[r]),n.push(i)}p.inst.StartModule(n)}else p.inst.StartModule({key:t,info:e||null,dynaimcList:o||null})},t.closeMod=function(t){t instanceof Array?t.forEach((function(t){p.inst.killModule(t)})):p.inst.killModule(t)},t.setLanType=function(t){var e;switch(t){case\"TW\":case\"HK\":case\"MO\":e=\"tw\";break;case\"CN\":case\"zh\":e=\"cn\";break;default:e=t}a.Language=e},t.getColorFilter=function(t,e,o){return new Laya.ColorFilter([t/255,0,0,0,0,0,e/255,0,0,0,0,0,o/255,0,0,0,0,0,1,0])},t}(),f=function(){function t(){this.errHdrList=new i,this.loaderList=new i,this.isLoaing=!1,this.d2ResLoadCom=!1,this.d3ResLoadCom=!1,this.totalCheckTime=2e4,this.checkRate=5e3,Laya.loader.on(Laya.Event.ERROR,this,this.onLoaingError)}return Object.defineProperty(t,\"ins\",{get:function(){return null==this._instance?this._instance=new t:this._instance},enumerable:!0,configurable:!0}),t.prototype.loadRes=function(t,e,o,n,r,i,a){var u;if(void 0===e&&(e=null),void 0===o&&(o=null),void 0===n&&(n=0),void 0===r&&(r=null),void 0===i&&(i=!1),void 0===a&&(a=!0),t instanceof Array){var l=this.getRealUrl(t[0])+\"_group\";u=null==o?this.getRealUrl(l):o}else u=null==o?this.getRealUrl(t):o;if(this.checkAllLoaded(t))return s.log(u+\" 已下载，直接返回回调。。\"),void(e&&e.run());if(this.loaderList.get(u)){var c=this.loaderList.get(u).cb;if(!c||!e||e==c)return s.log(\"有重复提交的加载请求，请检查代码=======\"),void this.loadNext();u+=\"_1\"}this.loaderList.set(u,{url:t,cb:e,wait:n,static:i,needscb:a}),r&&this.errHdrList.set(u,{url:t,cb:r}),this.loadNext()},t.prototype.loadResGroup=function(t,e,o,n,r,i){void 0===e&&(e=null),void 0===o&&(o=0),void 0===n&&(n=null),void 0===r&&(r=!1),void 0===i&&(i=!0);var a=l.getinstance().getResArray(t);a&&a.length&&this.loadRes(a,e,t,o,n,r,i)},t.prototype.getRes=function(t){return Laya.loader.getRes(t)},t.prototype.clearRes=function(t,e){void 0===e&&(e=null),Laya.loader.clearRes(t)},t.prototype.cancleLoader=function(t){t instanceof Array?Laya.loader.cancelLoadByUrls(t):Laya.loader.cancelLoadByUrl(t)},t.prototype.loadNext=function(){var t=this;if(!this.isLoaing&&0!=this.loaderList.keys.length){this.curLoadGroup=this.loaderList.keys[0];var e=this.loaderList.get(this.curLoadGroup).url;this.curWaitTime=this.loaderList.get(this.curLoadGroup).wait;var o=[],n=[],r=function(e){var r=t.getRealUrl(e);h.isD3Res(r)?n.push(r):\"string\"==typeof e?o.push({url:e,type:null}):o.push(e)};e instanceof Array?e.forEach((function(t){r(t)})):r(e),this.d2ResLoadCom=!Boolean(o.length),this.d3ResLoadCom=!Boolean(n.length),this.d2ResLoadCom&&this.d3ResLoadCom||this.startLoad(o,n)}},t.prototype.startLoad=function(t,e){this.isLoaing=!0,this.startTime=(new Date).getTime(),this.curWaitTime>0&&Laya.timer.loop(10,this,this.waitingTimerHdr),Laya.timer.loop(this.checkRate,this,this.checkLoadingStateHdr),t.length&&Laya.loader.load(t,h.Handler(this,this.onD2LoadingComHdr),Laya.Handler.create(this,this.onLoadingProgressHdr,null,!1),null,1,!0,this.curLoadGroup),e.length&&Laya.loader.create(e,h.Handler(this,this.onD3LoadingComHdr),Laya.Handler.create(this,this.onLoadingProgressHdr,null,!1))},t.prototype.onD2LoadingComHdr=function(t){null!=t&&0!=t||(s.log(this.curLoadGroup+\" 2d资源加载未完成。。\"),this.loaderList.get(this.curLoadGroup).needscb)?(this.d2ResLoadCom=!0,this.d2ResLoadCom&&this.d3ResLoadCom&&this.loadingComHdr(t)):this.stopCheck()},t.prototype.onD3LoadingComHdr=function(t){null!=t&&0!=t||(s.log(this.curLoadGroup+\" 3d资源加载未完成。。\"),this.loaderList.get(this.curLoadGroup).needscb)?(this.d3ResLoadCom=!0,this.d2ResLoadCom&&this.d3ResLoadCom&&this.loadingComHdr(t)):this.stopCheck()},t.prototype.loadingComHdr=function(t){this.isLoaing=!1,this.stopWaiting(),this.stopCheck();var e=this.curLoadGroup,o=(new Date).getTime()-this.startTime;t?s.log(this.curLoadGroup+\" 加载完成，所用时长：\"+o+\" ms\"):s.log(this.curLoadGroup+\" 加载未完成，所用时长：\"+o+\" ms\");var n,r=this.loaderList.get(this.curLoadGroup).cb;this.loaderList.get(this.curLoadGroup+\"_1\")&&(n=this.loaderList.get(this.curLoadGroup+\"_1\").cb,this.loaderList.remove(this.curLoadGroup+\"_1\"));var i=this.loaderList.get(this.curLoadGroup).wait;if(this.loaderList.remove(this.curLoadGroup),this.curLoadGroup=null,this.loadNext(),n&&n.runWith(t),r){if(i>0&&o>i+10)return void s.log(e+\" 加载超过设定等待时间\"+i+\" ms ,不执行回调==\");r.runWith(t)}},t.prototype.waitingTimerHdr=function(){if((new Date).getTime()-this.startTime>this.curWaitTime&&(this.stopWaiting(),!this.checkAllLoaded(this.loaderList.get(this.curLoadGroup).url))){var t=this.loaderList.get(this.curLoadGroup).cb;s.log(this.curLoadGroup+\" 加载超过设定等待时间==,返回null\"),t&&t.runWith(null)}},t.prototype.stopWaiting=function(){this.curWaitTime=0,Laya.timer.clear(this,this.waitingTimerHdr)},t.prototype.checkLoadingStateHdr=function(){if(this.totalCheckTime-=this.checkRate,s.log(this.curLoadGroup+\" ===loading检测：\",this.totalCheckTime),this.totalCheckTime<=0){this.stopCheck();var t=this.loaderList.get(this.curLoadGroup).url;this.checkAllLoaded(t)?(s.log(\"检测到资源已全部下载完成--------\",this.curLoadGroup),t instanceof Array?this.loadingComHdr(!0):this.loadingComHdr(this.getRes(this.getRealUrl(t)))):s.log(\"加载超时未完成。。。。\")}},t.prototype.alertToRefresh=function(){window.alert(\"加载超时未完成,检查资源路径或网络\"),location.reload()},t.prototype.stopCheck=function(){Laya.timer.clear(this,this.checkLoadingStateHdr),this.totalCheckTime=2e4},t.prototype.onLoadingProgressHdr=function(t){},t.prototype.getFileType=function(t){return Laya.Utils.getFileExtension(t)},t.prototype.checkAllLoaded=function(t){var e=this,o=!0,n=function(t){var o=e.getRealUrl(t);return!!Laya.loader.getRes(o)};if(t instanceof Array)for(var r=0;r<t.length&&(o=n(t[r]));r++);else o=n(t);return o},t.prototype.getRealUrl=function(t){return\"string\"==typeof t?t:t.url},t.prototype.onLoaingError=function(t){var e,o=this;this.isLoaing=!1,Laya.loader.clearRes(t),this.errHdrList.keys.forEach((function(n){if(e)return!1;var r=o.errHdrList.get(n);if(r.url instanceof Array)r.url.forEach((function(n){if(o.getRealUrl(n)==t)return e=r.cb,!1}));else if(o.getRealUrl(r.url)==t)return e=r.cb,o.errHdrList.remove(n),!1})),e&&e.runWith(t)},t._instance=null,t}(),d=function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),y=function(t){function e(){var e=t.call(this)||this;return e.imgurl=\"\",e}return d(e,t),e.prototype.loadExternal=function(){this.imgurl==this.url?this.displayObject.visible=!0:this.url?(\"atlas\"!=this.url.split(\"/\")[0]?-1!=this.url.indexOf(\"gif\")||-1!=this.url.indexOf(\"webp\")?this.imgurl=a.ImageUrl+this.url:this.imgurl=a.getFUIImg(this.url):\"http\"==this.url.slice(0,4)?this.imgurl=this.url:this.imgurl=\"res/\"+this.url+\".png\",f.ins.loadRes(this.imgurl,Laya.Handler.create(this,this.onLoadSuccess))):(this.displayObject.visible=!1,Laya.loader.clearTextureRes(this.imgurl))},e.prototype.freeExternal=function(t){this.displayObject.visible=!1,Laya.loader.clearTextureRes(this.imgurl)},e.prototype.onLoadSuccess=function(){var t=f.ins.getRes(this.imgurl);this.displayObject.visible=!0,t?this.onExternalLoadSuccess(t):this.url=null},e}(fgui.GLoader),g=function(){function t(){}return t.prototype.EnterState=function(t){this.cb=t.comCb,this.error=t.errCb},t.prototype.ExitState=function(){},t.prototype.onComplete=function(){this.cb&&this.cb.run()},t.prototype.onError=function(){this.error&&this.error.run()},t}(),_=function(){function t(){}return t.LAOGING=\"loading\",t.LAOGING_MEDIATOR=\"LAOGING_MEDIATOR\",t.HOME_PANEL=\"HOME_PANEL\",t.HOME_PANEL_MEDIATOR=\"HOME_PANEL_MEDIATOR\",t.GAME_LEVEL=\"GAME_LEVEL\",t.GAME_LEVEL_MEDIATOR=\"GAME_LEVEL_MEDIATOR\",t.NET=\"NET\",t.NET_MEDIATOR=\"NET_Mediator\",t.NET_PROXY=\"NET_PROXY\",t}(),L=function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return L(e,t),e.prototype.EnterState=function(e){t.prototype.EnterState.call(this,e),h.openMod(_.HOME_PANEL)},e.prototype.ExitState=function(){h.closeMod(_.HOME_PANEL)},e.prototype.onComplete=function(){},e}(g),R=function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return R(e,t),e.prototype.EnterState=function(e){t.prototype.EnterState.call(this,e),h.openMod(_.GAME_LEVEL)},e.prototype.ExitState=function(){h.closeMod(_.GAME_LEVEL)},e.prototype.onComplete=function(){},e}(g),O=function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),M=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return O(e,t),e.prototype.EnterState=function(e){t.prototype.EnterState.call(this,e),h.openMod(_.LAOGING)},e.prototype.ExitState=function(){h.closeMod(_.LAOGING)},e.prototype.onComplete=function(){},e}(g);!function(t){t[t.UnKnow=0]=\"UnKnow\",t[t.Loading=1]=\"Loading\",t[t.Home=2]=\"Home\",t[t.Level=3]=\"Level\"}(r||(r={}));var U=function(){function t(){this.mFSMList=new i,this.mFSMList.set(r.Loading,new M),this.mFSMList.set(r.Home,new m),this.mFSMList.set(r.Level,new v)}return Object.defineProperty(t,\"inst\",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!0,configurable:!0}),t.prototype.EnterGoalGameState=function(e){t.mCurrPlayState!==r.UnKnow&&e===t.mCurrPlayState||this.ChangeState(e)},t.prototype.ChangeState=function(e){t.mNewState=e,this.state=this.mFSMList.get(e),this.state&&(s.log(\"切换场景========\",this.state),t.mCurrPlayState!=r.UnKnow&&this.mFSMList.get(t.mCurrPlayState).ExitState(),t.mPriorPlayState=t.mCurrPlayState,t.mCurrPlayState=t.mNewState,this.state.EnterState({comCb:Laya.Handler.create(this,this.onComCallBack),errCb:Laya.Handler.create(this,this.onErrorCallBack)}))},t.prototype.onComCallBack=function(){s.log(\"进入新状态=====\")},t.prototype.onErrorCallBack=function(){t.mPriorPlayState!==r.UnKnow&&this.ChangeState(t.mPriorPlayState)},t.prototype.OnChangeComplete=function(e){e?t.mCurrPlayState!=r.UnKnow&&this.mFSMList.get(t.mCurrPlayState).onComplete():t.mCurrPlayState!=r.UnKnow&&this.mFSMList.get(t.mCurrPlayState).onError()},t.mCurrPlayState=r.UnKnow,t.mPriorPlayState=r.UnKnow,t.mNewState=r.UnKnow,t}(),b=function(){function t(){}return t.init=function(){},t.width=640,t.height=1136,t.scaleMode=\"fixedwidth\",t.screenMode=\"none\",t.alignV=\"top\",t.alignH=\"left\",t.startScene=\"\",t.sceneRoot=\"\",t.debug=!1,t.stat=!1,t.physicsDebug=!1,t.exportSceneToJson=!0,t}(),P=b;b.init();var S,C=function(){function t(){this.mPlatAdReady=!1}return Object.defineProperty(t,\"inst\",{get:function(){return h.getSingle(t)},enumerable:!0,configurable:!0}),t.prototype.init=function(){this.mPlatAdReady=!0},t.prototype.requestPayment=function(t,e,o,n){void 0===n&&(n=null)},t}();!function(t){t[t.AD=0]=\"AD\",t[t.BUY=1]=\"BUY\"}(S||(S={}));var G=function(){function t(){this._managers={}}return t.prototype.setup=function(t,e,o){void 0===o&&(o=60),this._stage=t,this._facade=e,this.super_setupManager(\"ModuleManager\",p),this.override_setup_game_managers()},t.prototype.super_setupManager=function(t,e){var o=\"ModuleManager\"==t?p.inst:new e;o&&(this._managers[t+\"\"]?console.warn(\"[core] error manager exist already -> \"+t):(this._managers[t+\"\"]=o,o.setup(this._stage,this._facade),s.log(\"[core] set up manager \"+t)))},t.prototype.super_getManager=function(t){return this._managers[t+\"\"]},t.prototype.override_setup_game_managers=function(){throw Error(\"请使用父类的super_setupManager(key:string)方法 扩展管理器！\")},Object.defineProperty(t.prototype,\"loaderMgr\",{get:function(){return this.super_getManager(\"LoaderManager\")},enumerable:!0,configurable:!0}),t}(),E=function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),A=function(t){function e(e){void 0===e&&(e=[]);var o=t.call(this)||this;return o._resGroup=[],o._resGroup=e,o}return E(e,t),e.prototype.start=function(t,e){void 0===e&&(e=null),this._commandNames=[],this._mediatorNames=[],this._proxyNames=[],this._data=e,this.facade=t,this.override_registerPureMvcAndStart()},e.prototype.dispose=function(){this._autoRemovePureMVC(),this.facade=null},e.prototype.getResGroup=function(){return this._resGroup},e.prototype.super_registerCommand=function(t,e){this.facade.registerCommand(t,e),this._commandNames.push(t)},e.prototype.super_registerMediator=function(t){this.facade.registerMediator(t),this._mediatorNames.push(t.getMediatorName())},e.prototype.super_registerProxy=function(t){this.facade.registerProxy(t),this._proxyNames.push(t.getProxyName())},e.prototype.override_registerPureMvcAndStart=function(){throw Error(\"[core] 请在override_registerPureMvcAndStart方法里，注册puremvc相关的command,proxy,mediator\")},Object.defineProperty(e.prototype,\"initData\",{get:function(){return this._data},enumerable:!0,configurable:!0}),e.prototype._autoRemovePureMVC=function(){if(this._commandNames){for(var t=this._commandNames.length,e=\"\";t--;)e=this._commandNames[t],this.facade.removeCommand(e);for(t=this._mediatorNames.length;t--;)e=this._mediatorNames[t],this.facade.removeMediator(e);for(t=this._proxyNames.length;t--;)e=this._proxyNames[t],this.facade.removeProxy(e)}this._commandNames=null,this._mediatorNames=null,this._proxyNames=null},e}(Laya.Sprite),w=function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),N=function(t){function e(){return t.call(this,_.LAOGING_MEDIATOR)||this}return w(e,t),e.prototype.listNotificationInterests=function(){return[]},e.prototype.handleNotification=function(t){t.getBody();t.getName()},e.prototype.onRegister=function(){s.log(\"====打开loading界面==\")},e.prototype.onRemove=function(){this.view&&this.view.dispose(),this.view=null},e}(puremvc.Mediator),x=function(){function t(){}return t.Loading=\"levelData\",t}(),T=function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),j=function(t){function e(){return t.call(this,[x.Loading])||this}return T(e,t),e.prototype.override_registerPureMvcAndStart=function(){this.super_registerMediator(new N)},e}(A),k=function(){function t(){}return t.prototype.setupPlugins=function(){p.inst.registerModule(_.LAOGING,j)},t.prototype.setup=function(t,e){},t.prototype.start=function(){},t}(),I=function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),F=function(t){function e(){return t.call(this)||this}return I(e,t),e.getInstance=function(){return e._instance||(e._instance=new e),e._instance},e.prototype.override_setup_game_managers=function(){this.super_setupManager(\"SetupManager\",k)},Object.defineProperty(e.prototype,\"setupMgr\",{get:function(){return this.super_getManager(\"SetupManager\")},enumerable:!0,configurable:!0}),e}(G);new(function(){function t(){window.Laya3D?Laya3D.init(P.width,P.height):Laya.init(P.width,P.height,Laya.WebGL),Laya.Physics&&Laya.Physics.enable(),Laya.DebugPanel&&Laya.DebugPanel.enable(),Laya.stage.scaleMode=P.scaleMode,Laya.stage.screenMode=P.screenMode,Laya.stage.alignV=P.alignV,Laya.stage.alignH=P.alignH,Laya.URL.exportSceneToJson=P.exportSceneToJson,(P.debug||\"true\"==Laya.Utils.getQueryString(\"debug\"))&&Laya.enableDebugPanel(),P.physicsDebug&&Laya.PhysicsDebugDraw&&Laya.PhysicsDebugDraw.enable(),P.stat&&Laya.Stat.show(),Laya.alertGlobalError=!0,Laya.ResourceVersion.enable(\"version.json\",Laya.Handler.create(this,this.onVersionLoaded),Laya.ResourceVersion.FILENAME_VERSION),F.getInstance().setup(Laya.stage,puremvc.Facade.getInstance()),F.getInstance().setupMgr.setupPlugins(),C.inst.init(),C.inst.mPlatAdReady=!1,this.initFont()}return t.prototype.onVersionLoaded=function(){Laya.AtlasInfoManager.enable(\"fileconfig.json\",Laya.Handler.create(this,this.onConfigLoaded))},t.prototype.onConfigLoaded=function(){f.ins.loadRes(l.RES_GROUP,h.Handler(this,this.LoadAllGameConfig))},t.prototype.LoadAllGameConfig=function(){this.initFGUICfg(),U.inst.EnterGoalGameState(r.Loading)},t.prototype.initFGUICfg=function(){fgui.UIConfig.packageFileExtension=\"obj\",fgui.UIConfig.defaultFont=\"huakang\",fgui.UIObjectFactory.setLoaderExtension(y),Laya.stage.addChild(fgui.GRoot.inst.displayObject),Laya.SoundManager.useAudioMusic=!Laya.Browser.onIOS,Laya.SoundManager.autoStopMusic=!0},t.prototype.initFont=function(){var t=new Laya.Text;t.text=\"曌\",t.font=\"huakang\"},t}())}]);","extractedComments":[]}